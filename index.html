<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pelada de Terça</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a1a; color: white; margin: 0; padding: 10px; overflow-x: hidden; }
        h2 { text-align: center; color: #4CAF50; margin: 5px 0; text-transform: uppercase; font-size: 1.2rem; }
        
        #campo-container {
            position: relative; width: 100%; max-width: 400px; height: 530px;
            background: #2e7d32; border: 3px solid white; border-radius: 12px;
            margin: 0 auto 15px;
            background-image: radial-gradient(circle at 50% 50%, transparent 15%, white 15.5%, transparent 16%),
                              linear-gradient(white, white);
            background-size: 100% 100%, 100% 2px; background-repeat: no-repeat; background-position: center;
        }

        .area-time {
            position: absolute; width: 94%; height: 46%; left: 3%;
            display: flex; flex-wrap: wrap; justify-content: center; align-content: flex-start;
            gap: 10px; padding: 25px 5px; box-sizing: border-box; z-index: 2;
        }

        #time-a { top: 1%; border-bottom: 1px dashed rgba(255,255,255,0.2); }
        #time-b { bottom: 1%; border-top: 1px dashed rgba(255,255,255,0.2); }

        .jogador { width: 65px; text-align: center; cursor: grab; -webkit-tap-highlight-color: transparent; }
        .foto-moldura {
            width: 52px; height: 52px; border-radius: 50%; border: 3px solid gold;
            background: #444; margin: 0 auto; overflow: hidden;
            background-size: cover; background-position: center;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        .nome-jogador { font-size: 10px; margin-top: 4px; font-weight: bold; text-shadow: 1px 1px 2px black; line-height: 1.1; }
        
        /* Destaque para Goleiros */
        .goleiro .foto-moldura { border-color: #ff5722; background-color: #222; }

        #reserva-container { background: #262626; padding: 15px; border-radius: 10px; max-width: 400px; margin: 0 auto; border: 1px solid #444; }
        #banco { display: flex; flex-wrap: wrap; gap: 12px; min-height: 100px; justify-content: center; }
        .secao-titulo { font-size: 11px; font-weight: bold; margin-bottom: 10px; color: #888; text-transform: uppercase; }
        .placeholder { opacity: 0.1; background: #fff; border-radius: 50%; }
    </style>
</head>
<body>

    <h2>⚽ Futebol de Terça</h2>
    
    <div id="campo-container">
        <div class="secao-titulo" style="position:absolute; top:8px; left:12px;">Time A</div>
        <div id="time-a" class="area-time"></div>
        <div class="secao-titulo" style="position:absolute; bottom:8px; left:12px;">Time B</div>
        <div id="time-b" class="area-time"></div>
    </div>

    <div id="reserva-container">
        <div class="secao-titulo">Banco de Reservas</div>
        <div id="banco"></div>
    </div>

    <script>
        // Função para converter links do Google Drive para link direto
        function converterFoto(url) {
            if (!url || !url.includes("drive.google.com")) return "";
            try {
                let id = "";
                if (url.includes("id=")) {
                    id = url.split("id=")[1].split("&")[0];
                } else {
                    id = url.split("/d/")[1].split("/")[0];
                }
                return `https://drive.google.com/uc?export=view&id=${id}`;
            } catch (e) { return ""; }
        }

        function carregarApp() {
            Papa.parse("jogadores.csv", {
                download: true,
                header: true,
                delimiter: ";", // O ponto e vírgula que está no seu arquivo
                skipEmptyLines: true,
                complete: function(results) {
                    const banco = document.getElementById('banco');
                    results.data.forEach(p => {
                        const nome = p.Jogador;
                        if (nome && nome.trim() !== "") {
                            // Verifica se é goleiro pela posição ou pelo nome
                            const ehGoleiro = (p.Posição && p.Posição.toUpperCase().includes("GOL")) || 
                                              (nome.toUpperCase().includes("GOL"));

                            const div = document.createElement('div');
                            div.className = `jogador ${ehGoleiro ? 'goleiro' : ''}`;
                            
                            const fotoFinal = converterFoto(p.Foto);
                            
                            div.innerHTML = `
                                <div class="foto-moldura" style="background-image: url('${fotoFinal}')">
                                    ${!fotoFinal ? nome.substring(0,2).toUpperCase() : ""}
                                </div>
                                <div class="nome-jogador">${nome}</div>
                            `;
                            banco.appendChild(div);
                        }
                    });

                    // Ativa o arraste
                    const config = { group: 'pelada', animation: 150, ghostClass: 'placeholder', forceFallback: true };
                    new Sortable(document.getElementById('time-a'), config);
                    new Sortable(document.getElementById('time-b'), config);
                    new Sortable(document.getElementById('banco'), config);
                }
            });
        }
        window.onload = carregarApp;
    </script>
</body>
</html>